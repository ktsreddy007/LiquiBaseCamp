steps:
  - script: |
      set -euo pipefail
      echo "=== Setting up Java & Liquibase PATH ==="
      echo "JAVA_HOME=$JAVA_HOME"
      echo "LIQUIBASE_HOME=$LIQUIBASE_HOME"

      echo "##vso[task.prependpath]$JAVA_HOME/bin"
      echo "##vso[task.prependpath]$LIQUIBASE_HOME"

      echo "PATH is now: $PATH"
      if [ ! -x "$LIQUIBASE_HOME/liquibase" ]; then
        echo "ERROR: Liquibase executable not found at $LIQUIBASE_HOME/liquibase"
        exit 1
      fi
      echo "Liquibase executable verified."

      # Verify DB vars
      echo "[DEBUG] DB_URL=$DB_URL"
      echo "[DEBUG] DB_USERNAME=$DB_USERNAME"
      echo "[DEBUG] DB_PASSWORD set? ${DB_PASSWORD:+yes}"
    displayName: "Setup & Verify Environment"
    env:
      DB_URL: $(DB_URL)
      DB_USERNAME: $(DB_USERNAME)
      DB_PASSWORD: $(DB_PASSWORD)
      JAVA_HOME: $(JAVA_HOME)
      LIQUIBASE_HOME: $(LIQUIBASE_HOME)
    